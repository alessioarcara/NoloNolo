(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[15],{104:function(e,t,a){"use strict";var n=a(3),c=a(98),i=a.n(c),s=(a(127),a(105),a(132)),r=a(0),o=a(137),l=a(1);Object(c.registerLocale)("it",s.a);t.a=function(e){var t=e.minDate,a=e.start,c=e.end,s=e.onChangeStartDate,d=e.onChangeEndDate,u=e.monthsShown,b=e.alreadyRentedDates,j=Object(r.useMemo)((function(){var e=[];return b&&b.forEach((function(t){for(var a=new Date(t.from),n=new Date(t.to),c=a;c<=n;c=Object(o.default)(c,1))e.push(c)})),e}),[b]);return Object(l.jsx)(i.a,{locale:"it",wrapperClassName:"input-container",minDate:t&&t,selected:a,startDate:a,endDate:c,onChange:function(e){var t=Object(n.a)(e,2),a=t[0],c=t[1];s(a),d(c)},monthsShown:u,calendarStartDay:1,selectsRange:!0,inline:!0,excludeDates:j})}},105:function(e,t,a){},109:function(e,t,a){"use strict";var n=a(82),c=a(84),i=a(104),s=a(111),r=a.n(s),o=a(1);t.a=function(e){var t=e.minDate,a=e.moveClickHandler,s=e.changeStartDateHandler,l=e.changeEndDateHandler,d=e.searchClickHandler,u=e.cancelSelectionHandler,b=e.startDate,j=e.endDate,m=e.skipTextButton,O=e.confirmTextButton,f=e.alreadyRentedDates;return Object(o.jsxs)("div",{className:r.a["datepicker-container"],children:[Object(o.jsxs)("div",{className:r.a["header-datepicker"],children:[Object(o.jsx)(n.a,{actionClassName:r.a["actions-top"],firstButtonClassName:"btn ".concat(r.a["btn-back"]),firstButtonClickHandler:a,firstButtonText:Object(o.jsx)(c.a,{}),secondButtonClassName:"btn btn-secondary ".concat(r.a["btn-cancel"]),secondButtonClickHandler:u,secondButtonText:"Cancella"}),Object(o.jsxs)("ul",{className:r.a["days-text"],children:[Object(o.jsx)("li",{children:"lun"}),Object(o.jsx)("li",{children:"mar"}),Object(o.jsx)("li",{children:"mer"}),Object(o.jsx)("li",{children:"gio"}),Object(o.jsx)("li",{children:"ven"}),Object(o.jsx)("li",{children:"sab"}),Object(o.jsx)("li",{children:"dom"})]})]}),Object(o.jsx)("div",{className:r.a["day-picker"],children:Object(o.jsx)(i.a,{minDate:t,start:b,end:j,monthsShown:2,onChangeStartDate:s,onChangeEndDate:l,alreadyRentedDates:f})}),Object(o.jsx)(n.a,{actionClassName:(m||O)&&r.a["actions-bottom"],firstButtonClassName:m?"btn btn-secondary ".concat(r.a["btn-skip"]):r.a.hide,firstButtonClickHandler:m&&d,firstButtonText:m&&m,secondButtonClassName:O?"btn btn-outline-primary":r.a.hide,secondButtonClickHandler:O&&d,secondButtonText:O,secondButtonDisabled:!b||!j||b.getTime()===j.getTime()})]})}},111:function(e,t,a){e.exports={"datepicker-container":"SelectDates_datepicker-container__2CEui",hide:"SelectDates_hide__2pWwh","header-datepicker":"SelectDates_header-datepicker__1wQlw","btn-cancel":"SelectDates_btn-cancel__3cZ2Q","days-text":"SelectDates_days-text__3KDIa","actions-top":"SelectDates_actions-top__37iWM","actions-bottom":"SelectDates_actions-bottom__1AKcx","btn-back":"SelectDates_btn-back__11LuK","btn-skip":"SelectDates_btn-skip__2Wdyl","day-picker":"SelectDates_day-picker__2qrWC"}},112:function(e,t,a){"use strict";a.d(t,"b",(function(){return i}));var n=a(7),c=a(24),i={startDate:null,endDate:null,city:"",region:"",isNextPage:!1};t.a=function(e,t){var a=t.type,s=t.payload;switch(a){case c.t:return Object(n.a)(Object(n.a)({},e),{},{isNextPage:!e.isNextPage,city:s.city,region:s.region});case c.c:return Object(n.a)(Object(n.a)({},e),{},{startDate:s});case c.b:return Object(n.a)(Object(n.a)({},e),{},{endDate:s});case c.d:return Object(n.a)(Object(n.a)({},e),{},{startDate:null,endDate:null});default:return i}}},115:function(e,t,a){"use strict";var n=a(116),c=a.n(n),i=a(1);t.a=function(e){var t=e.children;return Object(i.jsx)("div",{className:c.a["results-layout"],children:t})}},116:function(e,t,a){e.exports={"results-layout":"BoatListLayout_results-layout__29ZwG"}},121:function(e,t,a){"use strict";var n=a(7),c=a(3),i=a(0),s=a(122),r=a.n(s),o=a(26),l=a.n(o),d=a(1),u=function(e){var t=e.message,a=e.status,n=e.duration,s=void 0===n?3e3:n,o=Object(i.useState)(!0),l=Object(c.a)(o,2),u=l[0],b=l[1],j=r.a.default;"error"===a&&(j=r.a.error),"success"===a&&(j=r.a.success);var m="".concat(r.a.notification," ").concat(j);return Object(i.useEffect)((function(){!0===u&&setTimeout((function(){b(!1)}),s)}),[u]),u?Object(d.jsx)("div",{className:m,children:t}):null};t.a=function(e){return l.a.createPortal(Object(d.jsx)(u,Object(n.a)({},e)),document.getElementById("overlay-root"))}},122:function(e,t,a){e.exports={notification:"Notification_notification__3buj9","slide-down":"Notification_slide-down__1tich",default:"Notification_default__UhEQ8",error:"Notification_error__21fFx",success:"Notification_success__sVwJ2"}},272:function(e,t,a){e.exports={"bottom-header":"RentalsHeader_bottom-header__33fQe","windows-bar":"RentalsHeader_windows-bar__3JXJB",normal:"RentalsHeader_normal__1SQBL",selected:"RentalsHeader_selected__2aFdB"}},273:function(e,t,a){e.exports={"bottom-container":"DatesModal_bottom-container__bgJYx","total-amount":"DatesModal_total-amount__2F2VM","btn-update":"DatesModal_btn-update__rqyWy"}},278:function(e,t,a){e.exports={"review-container":"ReviewModal_review-container__2eXBD","review-title":"ReviewModal_review-title__12zeB","five-stars":"ReviewModal_five-stars__34MVp",quote:"ReviewModal_quote__3f4wD",stars:"ReviewModal_stars__2_w44","review-text-container":"ReviewModal_review-text-container__3RLmN","review-text":"ReviewModal_review-text__wxejy","btn-publish":"ReviewModal_btn-publish__1vtuJ","created-at-container":"ReviewModal_created-at-container__24g9U"}},280:function(e,t,a){e.exports={"card-container":"RentalCard_card-container__2iPuy","delete-card":"RentalCard_delete-card__1ivM6","details-container":"RentalCard_details-container__2cdGz","details-section":"RentalCard_details-section__22XZo","optional-section":"RentalCard_optional-section__2QBef","delete-section":"RentalCard_delete-section__s7p1P",dates:"RentalCard_dates__3ioRj",price:"RentalCard_price__1FEHe",option:"RentalCard_option__2Oifu","btn-confirm":"RentalCard_btn-confirm__2T-rK"}},314:function(e,t,a){"use strict";a.r(t);var n=a(3),c=a(7),i=a(2),s=a(0),r=a.n(s),o=a(272),l=a.n(o),d=a(8),u=a(88),b=a(84),j=a(1),m=function(){return Object(j.jsx)(u.a,{textTitle:"Noleggi",backElement:Object(j.jsx)(b.a,{}),navigatePath:"/profile",classNameHeader:l.a["bottom-header"],children:Object(j.jsxs)("div",{className:l.a["windows-bar"],children:[Object(j.jsx)(d.c,{to:"previous",className:function(e){var t=e.isActive;return"".concat(l.a.normal)+(t?" ".concat(l.a.selected):"")},children:Object(j.jsx)("span",{children:"Passati"})}),Object(j.jsx)(d.c,{to:"active",className:function(e){var t=e.isActive;return"".concat(l.a.normal)+(t?" ".concat(l.a.selected):"")},children:Object(j.jsx)("span",{children:"Attivi"})}),Object(j.jsx)(d.c,{to:"future",className:function(e){var t=e.isActive;return"".concat(l.a.normal)+(t?" ".concat(l.a.selected):"")},children:Object(j.jsx)("span",{children:"Futuri"})})]})})},O=r.a.memo(m),f=a(25),_=a(11),v=a(9),x=a(97),h=a(71),p=a(75),D=a(28),w=a(109),y=a(24),g=a(112),N=a(273),R=a.n(N),C=a(137),k=function(e){var t=e.boatId,a=e.rentalId,i=e.start,r=e.end,o=e.dailyFee,l=e.fixedFee,d=e.onUpdateRentalDates,u=e.onGoRentalsPage,b=Object(s.useContext)(v.b).token,m=Object(s.useReducer)(g.a,Object(c.a)(Object(c.a)({},g.b),{},{startDate:new Date(i),endDate:new Date(r)})),O=Object(n.a)(m,2),x=O[0],p=O[1],D=Object(s.useCallback)((function(){p({type:y.d})}),[p]),N=Object(s.useCallback)((function(e){p({type:y.c,payload:e})}),[p]),k=Object(s.useCallback)((function(e){p({type:y.b,payload:e})}),[p]),B=Object(f.a)(!0),F=B.data,S=B.sendRequest,M=Object(s.useMemo)((function(){return Object(h.p)(F,i,r)}),[F,i,r]);return Object(s.useEffect)((function(){S({body:Object(_.body_boatRentals)({boatId:t}),token:b},(function(e){return e.boatRentals}))}),[S,b,t]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(w.a,{minDate:Object(C.default)(new Date,1),startDate:x.startDate,endDate:x.endDate,moveClickHandler:u,changeStartDateHandler:N,changeEndDateHandler:k,cancelSelectionHandler:D,alreadyRentedDates:M}),Object(j.jsxs)("div",{className:R.a["bottom-container"],children:[Object(j.jsx)("span",{className:R.a["total-amount"],children:x.endDate&&0!==Object(h.o)(x.startDate,x.endDate)?"Totale ".concat(Object(h.k)(Object(h.d)(o,l,x.startDate,x.endDate))):""}),Object(j.jsx)("button",{className:"".concat(R.a["btn-update"]," btn btn-outline-primary"),onClick:function(){d(Object(_.body_updateRental)({rentalId:a,from:x.startDate,to:x.endDate}),(function(e,t){return e.map((function(e){return e._id===t._id?t:e}))}))},disabled:!x.endDate||Object(h.i)(x.startDate)===Object(h.i)(x.endDate),children:"Aggiorna"})]})]})},B=a(168),F=a(278),S=a.n(F),M=a(170),A=["Scadente","Non buono","Buono","Ottimo","Eccellente"],H=function(e){var t=e.rentalId,a=e.review,i=e.isReviewed,r=e.onPublishReview,o=Object(s.useState)(),l=Object(n.a)(o,2),d=l[0],u=l[1],b=Object(s.useState)(""),m=Object(n.a)(b,2),O=m[0],f=m[1],v=Object(s.useCallback)((function(e){return u(e)}),[]),x=Object(s.useCallback)((function(e){return f(e.target.value)}),[]);return Object(j.jsx)("form",{onSubmit:function(e){e.preventDefault(),r(Object(_.body_publishReview)({rentalId:t,body:O,rating:parseInt(d)+1}),(function(e,t){return e.map((function(e){return e._id===t.rental?Object(c.a)(Object(c.a)({},e),{},{boat:Object(c.a)(Object(c.a)({},e.boat),{},{reviews:e.boat.reviews.concat(t)})}):e}))}))},children:Object(j.jsxs)("div",{className:S.a["review-container"],children:[Object(j.jsx)("span",{className:S.a["review-title"],children:i?"La tua recensione":"Scrivi la tua recensione!"}),Object(j.jsxs)("div",{className:S.a["five-stars"],children:[Object(j.jsx)("span",{className:S.a.quote,children:i?"Valutata: ".concat(A[a.rating-1]):A[d]?A[d]:"Valuta questa barca"}),Object(j.jsx)("div",{className:S.a.stars,children:Object(j.jsx)(M.a,{votes:A,quoteIndex:i?a.rating-1:d,changeQuoteIndex:v,placeholder:i})})]}),Object(j.jsxs)("div",{className:S.a["review-text-container"],children:[Object(j.jsx)("span",{children:i?"Il tuo feedback:":"Lasciaci il tuo feedback:"}),Object(j.jsx)("textarea",{className:S.a["review-text"],onChange:x,value:i?a.body:O,disabled:i})]}),Object(j.jsx)("div",{className:"".concat(i?S.a["created-at-container"]:"hide"),children:Object(j.jsxs)("span",{children:["Lasciata il ",i&&Object(h.j)(new Date(+a.createdAt),{day:"numeric",month:"long",year:"numeric"})]})}),Object(j.jsx)("button",{className:"".concat(S.a["btn-publish"]," btn btn-outline-primary ").concat(i&&"hide"),disabled:!d||O.length<10,children:"Pubblica"})]})})},I=a(280),T=a.n(I),E=a(131),P=function(e){var t=e.onMutateRentals,a=e.rentalId,c=e.boatId,r=e.previous,o=e.active,l=e.future,d=e.images,u=e.from,b=e.to,m=e.city,O=e.billNumber,f=e.boatData,v=e.customer,w=e.createdAt,y=e.rentalDailyFee,g=e.rentalFixedFee,N=e.advertisementDailyFee,R=e.advertisementFixedFee,C=e.redeliveryDate,F=e.totalAmount,S=e.review,M=e.isReviewed,A=Object(s.useContext)(D.b),I=Object(i.h)(),P=Object(s.useState)(""),L=Object(n.a)(P,2),q=L[0],z=L[1],U=Object(s.useCallback)((function(e){return e.target.dataset.modal?z(e.target.dataset.modal):z("")}),[]),J=Object(s.useCallback)((function(e,a){t(e,a),z("")}),[t]),Q=Object(s.useCallback)((function(){t(Object(_.body_deleteRental)({rentalId:a}),(function(e,t){return e.filter((function(e){return e._id!==t}))}))}),[t,a]),V=Object(s.useCallback)((function(){I("/boats/".concat(c),{state:{startUrlDate:u,endUrlDate:b}})}),[I,c,u,b]);return Object(j.jsxs)(j.Fragment,{children:[""!==q&&Object(j.jsxs)(p.a,{closeModalHandler:U,adapterSize:"dates"===q&&A.breakpoint,children:["review"===q&&Object(j.jsx)(H,{rentalId:a,customerId:v._id,review:S,onPublishReview:J,isReviewed:M}),"delete"===q&&Object(j.jsx)(E.a,{text:"Eliminare questo noleggio?",onConfirm:Q}),"dates"===q&&Object(j.jsx)(k,{onUpdateRentalDates:J,boatId:c,rentalId:a,start:u,end:b,dailyFee:N,fixedFee:R,onGoRentalsPage:U}),"bill"===q&&Object(j.jsx)(B.a,{billNumber:O,from:u,to:b,boatData:f,customer:v.email,createdAt:w,dailyFee:y,fixedFee:g,redeliveryDate:C,totalAmount:F})]}),Object(j.jsxs)("div",{className:T.a["card-container"],children:[Object(j.jsx)("button",{"data-modal":"delete",className:"".concat(T.a["delete-card"]," ").concat(!l&&"hide"),onClick:U,children:"\xd7"}),Object(j.jsx)(x.a,{images:d}),Object(j.jsxs)("div",{className:T.a["details-container"],children:[Object(j.jsxs)("section",{onClick:V,className:T.a["details-section"],children:[Object(j.jsx)("span",{className:T.a.dates,children:"".concat(Object(h.j)(new Date(u),{day:"numeric",month:"short",year:"numeric"})," - ").concat(Object(h.j)(new Date(b),{day:"numeric",month:"short",year:"numeric"}))}),Object(j.jsx)("span",{className:"card-title",children:m}),Object(j.jsx)("span",{className:T.a.price,children:"Prezzo totale ".concat(Object(h.k)(F))})]}),Object(j.jsxs)("section",{className:"".concat(T.a["optional-section"]," ").concat(o&&"hide"),children:[Object(j.jsx)("button",{"data-modal":"dates",className:"".concat(T.a.option," ").concat(!l&&"hide"),onClick:U,children:"Modifica date"}),Object(j.jsx)("button",{"data-modal":"bill",className:"".concat(T.a.option," ").concat(!r&&"hide"),onClick:U,children:"Mostra fattura"}),Object(j.jsx)("button",{"data-modal":"review",className:"".concat(T.a.option," ").concat(!r&&"hide"),onClick:U,children:M?"Mostra recensione":"Lascia recensione"})]})]})]})]})},L=a(89),q=a(115),z=a(87),U=function(e){var t=e.onMutateRentals,a=e.previousRentals,n=e.activeRentals,c=e.futureRentals,i=e.previous,r=e.active,o=e.future,l=Object(s.useCallback)((function(){return a||n||c}),[a,n,c]),d=Object(s.useMemo)((function(){return i?"passati":r?"attivi":o?"futuri":""}),[i,r,o]);return 0===l().length?Object(j.jsx)(L.a,{warningText:"Non ci sono noleggi ".concat(d,". Inizia a noleggiare la tua barca!"),warningTextButton:"Noleggia",path:"/"}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(q.a,{children:l().map((function(e){return Object(j.jsx)(P,{onMutateRentals:t,rentalId:e._id,boatId:e.boat._id,previous:i,active:r,future:o,from:e.from,to:e.to,redeliveryDate:e.redelivery,city:e.boat.isDocked.city,totalAmount:Object(h.d)(e.dailyFee,e.fixedFee,e.from,e.to,e.redelivery),images:e.boat.hasAdvertisement?e.boat.hasAdvertisement.images:[],billNumber:e.billNumber,boatData:e.boat,customer:e.customer,createdAt:e.createdAt,rentalDailyFee:e.dailyFee,rentalFixedFee:e.fixedFee,advertisementDailyFee:e.boat.hasAdvertisement?e.boat.hasAdvertisement.dailyFee:0,advertisementFixedFee:e.boat.hasAdvertisement?e.boat.hasAdvertisement.fixedFee:0,review:e.boat.reviews.filter((function(t){return t.rental===e._id&&t.creator._id===e.customer._id}))[0],isReviewed:e.isReviewed},e._id)}))}),Object(j.jsx)(z.a,{heightVh:5})]})},J=r.a.memo(U),Q=a(121);t.default=function(){var e=Object(s.useContext)(v.b).token,t=Object(i.i)(),a=Object(s.useState)([]),r=Object(n.a)(a,2),o=r[0],l=r[1],d=Object(f.a)(!0),u=d.status,b=d.data,m=d.error,x=d.sendRequest,p=Object(s.useRef)(!1),D=Object(s.useMemo)((function(){return function(e){return{previous:e?e.reduce((function(e,t){return t.redelivery&&e.push(t.boat.reviews.some((function(e){return e.rental===t._id&&e.creator._id===t.customer._id}))?Object(c.a)(Object(c.a)({},t),{},{isReviewed:!0}):Object(c.a)(Object(c.a)({},t),{},{isReviewed:!1})),e}),[]):[],active:e?e.filter((function(e){return new Date(e.from)<=new Date&&!e.redelivery})):[],future:e?e.filter((function(e){return new Date(e.from)>new Date})):[]}}(o)}),[o]),w=Object(s.useCallback)((function(t,a){x({body:t,token:e},Object(h.m)(l,a)),p.current=!0}),[x,e]);return Object(s.useEffect)((function(){x({body:_.body_userRentals,token:e},(function(e){return l(e.rentalsByUser)}))}),[x,e]),Object(j.jsxs)(j.Fragment,{children:[p.current&&"completed"===u&&!b&&!m&&Object(j.jsx)(Q.a,{message:"Operazione riuscita",status:"success"}),p.current&&"completed"===u&&(b||m)&&Object(j.jsx)(Q.a,{message:"Operazione fallita",status:"error"}),Object(j.jsx)(O,{}),Object(j.jsxs)(i.e,{children:[Object(j.jsx)(i.c,{path:"previous",element:Object(j.jsx)(J,{onMutateRentals:w,previousRentals:D.previous,previous:!0})}),Object(j.jsx)(i.c,{path:"active",element:Object(j.jsx)(J,{activeRentals:D.active,active:!0})}),Object(j.jsx)(i.c,{path:"future",element:Object(j.jsx)(J,{onMutateRentals:w,futureRentals:D.future,future:!0})}),Object(j.jsx)(i.c,{path:"/",element:"PUSH"===t?Object(j.jsx)(i.a,{to:"active"}):Object(j.jsx)(i.a,{to:"/profile"})})]})]})}},74:function(e,t,a){"use strict";var n=a(0),c=a.n(n),i=a(76),s=a.n(i),r=a(27),o=a(1),l=function(e){var t=e.type,a=e.className,n=e.onClick,c=e.disabled,i=e.isLoading,l=e.children;return Object(o.jsx)("button",{type:t||"submit",className:a||s.a.Button,onClick:n,disabled:c,children:i?Object(o.jsx)(r.a,{}):l})};t.a=c.a.memo(l)},76:function(e,t,a){e.exports={Button:"Button_Button__3gFiX"}},82:function(e,t,a){"use strict";var n=a(0),c=a.n(n),i=a(74),s=a(83),r=a.n(s),o=a(1),l=function(e){var t=e.actionClassName,a=e.firstButtonClassName,n=e.firstButtonClickHandler,c=e.firstButtonText,s=e.firstButtonDisabled,l=e.secondButtonClassName,d=e.secondButtonClickHandler,u=e.secondButtonText,b=e.secondButtonDisabled,j=e.secondButtonType;return Object(o.jsxs)("div",{className:t||r.a.actions,children:[Object(o.jsx)(i.a,{className:a||r.a["btn-first"],onClick:n,disabled:s,type:"button",children:c}),Object(o.jsx)(i.a,{className:"".concat(l," ").concat(r.a["btn-second"]),onClick:d,disabled:b,type:j||"button",children:u})]})};t.a=c.a.memo(l)},83:function(e,t,a){e.exports={actions:"ActionButton_actions__27dZ-","btn-first":"ActionButton_btn-first__v2NlO","btn-second":"ActionButton_btn-second__1MDkF"}},87:function(e,t,a){"use strict";var n=a(1);t.a=function(e){var t=e.heightVh,a=e.widthRatio,c=void 0===a?100:a;return Object(n.jsx)("div",{style:{height:"".concat(t,"vh"),width:"".concat(c,"%")}})}}}]);
//# sourceMappingURL=15.2106405b.chunk.js.map